version: 1
task_definition:
  ecs_task_definition:
    task_execution_role: ecsTaskExecutionRole
    task_role_arn: ecsTaskRole
    task_size:
      cpu_limit: 1024
      mem_limit: 2048
  network_configuration:
    awsvpc_configuration:
      subnets:
        - "subnet-xxxxxxxxxx"  # Replace with your subnet IDs
        - "subnet-yyyyyyyyyy"
      security_groups:
        - "sg-xxxxxxxxxx"      # Replace with your security group ID
      assign_public_ip: ENABLED
  load_balancers:
    - target_group_arn: "arn:aws:elasticloadbalancing:${AWS_REGION}:${AWS_ACCOUNT_ID}:targetgroup/rag-system-targets"  # Replace with your target group ARN
      container_name: "rag-api"
      container_port: 3000
  service:
    desired_count: 1
    minimum_healthy_percent: 50
    deployment_configuration:
      maximum_percent: 200
      minimum_healthy_percent: 50